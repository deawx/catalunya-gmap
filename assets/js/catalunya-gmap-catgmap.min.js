/*! Generated 17-08-2017 */

!function(e,t,r){var i=function(){function e(e,i,n){this.debug=n.debug,this.serverHost=n.serverHost,this.gMap=new t.maps.Map(e,i),this.markers=r.create(),this.icons=r.create();var s={minimumClusterSize:15};this.markerClusterer=new MarkerClusterer(this.gMap,[],s),this.infowindow=new t.maps.InfoWindow,this.fullScreen=!0,this.useMarkerCluster=n.useMarkerCluster,this.arrayCategoriesText=r.create(),this.bounds=new t.maps.LatLngBounds,this._setLogoCatalunyaMedieval(),this._setIconFullScreen()}return e.prototype={_setLogoCatalunyaMedieval:function(){var e=document.createElement("div");e.index=10,e.style.padding="0px";var r=document.createElement("img");r.src=this.serverHost+"/assets/images/logo/logoCM-red-mini.png",r.style.cursor="pointer",e.appendChild(r),this.gMap.controls[t.maps.ControlPosition.BOTTOM_LEFT].push(e)},_setIconFullScreen:function(e){var r=this,i=document.createElement("div");i.style.padding="2px";var n=document.createElement("div");n.style.cursor="pointer",n.style.textAlign="center",n.title="Click per mostrar o ocultar el llistat",n.style.visibility="visible",i.appendChild(n);var s=document.createElement("div");s.id="llistat",s.innerHTML='<img src="'+this.serverHost+'/assets/images/gmap/03.png" with="42" height="42" alt="Mostrar llistat" >',n.appendChild(s),this.gMap.controls[t.maps.ControlPosition.TOP_RIGHT].push(i),t.maps.event.addDomListener(n,"click",function(){$("#primaryDiv").toggleClass("primaryDiv"),r._resize(),$("#secondaryDiv").toggle(),r.fullScreen?(r.fullScreen=!1,$("#llistat").html('<img src="'+r.serverHost+'/assets/images/gmap/04.png" with="42" height="42" alt="Ocultar llistat" >')):(r.fullScreen=!0,$("#llistat").html('<img src="'+r.serverHost+'/assets/images/gmap/03.png" with="42" height="42" alt="Mostrar llistat" >'))})},_resize:function(e){if(this.markerClusterer.getMarkers().length>0)this.debug&&(console.log("markerClusterer : it is not empty!"),console.log("Recenter markers!")),this._refreshMap(),this.markerClusterer.fitMapToMarkers(),this.markerClusterer.repaint();else{this.debug&&(console.log("markerClusterer : it is empty!"),console.log("Recenter the map to Catalunya Area"));var r=new t.maps.LatLng(41.44090875484817,1.81713925781257);this.gMap.setZoom(8),this.gMap.setCenter(r)}this._refreshMap()},_refreshMap:function(){this.debug&&console.log("refreshing map!"),t.maps.event.trigger(this.gMap,"resize")},_on:function(e){var r=this;t.maps.event.addListener(e.obj,e.event,function(t){return e.callback.call(r,t)})},_createMarker:function(e){return e.map=this.gMap,new t.maps.Marker(e)},_createIcon:function(e){var r=document.createElement("div");r.style.padding="2px";var i=document.createElement("div");i.style.cursor="pointer",i.style.textAlign="center",i.title="Click per activar o desactivar "+e.title,r.appendChild(i);var n=document.createElement("div");n.innerHTML='<img src="'+e.icon+'" alt="'+e.title+'" >',i.appendChild(n),this.gMap.controls[t.maps.ControlPosition.RIGHT_TOP].push(r);var s=this;return t.maps.event.addDomListener(i,"click",function(){e.visible?(e.visible=!1,n.style.opacity="0.5"):(e.visible=!0,n.style.opacity="1"),s._setVisible(e.category,e.visible),s.markerClusterer.resetViewport_(),s.markerClusterer.redraw_()}),r},_setVisible:function(e,t){t?(this.enableBy(function(t){return t.category===e}),this._enableText(e)):(this.disableBy(function(t){return t.category===e}),this._disableText(e))},addIcon:function(e){var t;t=this._createIcon(e),this.icons.add(t)},removeIcon:function(e){},addMarker:function(e){var r;e.position={lat:e.lat,lng:e.lng},r=this._createMarker(e),this.bounds.extend(r.getPosition()),this.useMarkerCluster&&this.markerClusterer.addMarker(r),this.markers.add(r),e.event&&this._on({obj:r,event:e.event.name,callback:e.event.callback}),e.content&&this._on({obj:r,event:"click",callback:function(){this.infowindow.setContent(e.content),this.infowindow.setPosition(r.getPosition()),this.infowindow.open(this.gMap,r)}}),this._createMarkerButton(r,e),t.maps.event.addListener(this.infowindow,"domready",function(){var e=$(".gm-style-iw").prev();e.css({"background-color":"#fff6eb"}),e.children(":nth-child(4)").css({"background-color":"#fff6eb"}),e.children(":nth-child(3)").children(":nth-child(1)").children(":nth-child(1)").css({"background-color":"#fff6eb"}),e.children(":nth-child(3)").children(":nth-child(2)").children(":nth-child(1)").css({"background-color":"#fff6eb"})})},_createMarkerButton:function(e,r){var i=document.getElementById("mapLlist");if(!this.arrayCategoriesText.exist(r.category)){this.arrayCategoriesText.add(r.category);var n=document.createElement("li"),s=r.categoryName;n.innerHTML=s,n.setAttribute("class",r.category+" header"),i.appendChild(n)}var a=document.createElement("li"),o=r.title;a.innerHTML=o,a.setAttribute("class",r.category),i.appendChild(a);var l=this;t.maps.event.addDomListener(a,"click",function(){l.gMap.setZoom(15),l.gMap.setCenter(e.getPosition()),l.gMap.setTilt(1),t.maps.event.trigger(e,"click")}),t.maps.event.addDomListener(a,"mouseover",function(){e.setZIndex(2e3),e.setIcon(r.icon2)}),t.maps.event.addDomListener(a,"mouseout",function(){e.setZIndex(1),e.setIcon(r.icon)})},findBy:function(e){return this.markers.find(e)},removeBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){t.markerClusterer?t.markerClusterer.removeMarker(e):e.setMap(null)})})},_enableText:function(e){var e="."+e;$(e).each(function(){$(this).show()})},_disableText:function(e){var e="."+e;$(e).each(function(){$(this).hide()})},enableBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){e.setVisible(!0),t.markerClusterer.addMarker(e,!0)})}),this._resize()},disableBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){e.setVisible(!1),t.markerClusterer.removeMarker(e,!0)})}),this._resize()},_getMarkers:function(){return this.markers},zoom:function(e){if(!e)return this.gMap.getZoom();this.gMap.setZoom(e)}},e}();i.create=function(e,t,r){var e=document.getElementById(e);return new i(e,t,r)},e.Gmap=i}(window,google,List);