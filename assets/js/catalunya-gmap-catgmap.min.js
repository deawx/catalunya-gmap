/*! Generated 15-08-2017 */

!function(e,t,r){var n=function(){function e(e,n,i){this.debug=i.debug,this.serverHost=i.serverHost,this.gMap=new t.maps.Map(e,n),this.markers=r.create(),this.icons=r.create(),this.markerClusterer=new MarkerClusterer(this.gMap,[]),this.infowindow=new t.maps.InfoWindow,this.bounds=new t.maps.LatLngBounds,this._setLogoCatalunyaMedieval()}return e.prototype={_setLogoCatalunyaMedieval:function(){var e=document.createElement("div");e.index=10,e.style.padding="0px";var r=document.createElement("img");r.src=this.serverHost+"/assets/images/logo/logoCM-red-mini.png",r.style.cursor="pointer",e.appendChild(r),this.gMap.controls[t.maps.ControlPosition.BOTTOM_LEFT].push(e)},_resize:function(){if(this.markerClusterer.getMarkers().length>0)this.debug&&(console.log("markerClusterer : it is not empty!"),console.log("Recenter markers!")),this.markerClusterer.fitMapToMarkers(),this.markerClusterer.repaint();else{this.debug&&(console.log("markerClusterer : it is empty!"),console.log("Recenter the map to Catalunya Area"));var e=new t.maps.LatLng(41.44090875484817,1.81713925781257);this.gMap.setZoom(8),this.gMap.setCenter(e)}},_on:function(e){var r=this;t.maps.event.addListener(e.obj,e.event,function(t){return e.callback.call(r,t)})},_createMarker:function(e){return e.map=this.gMap,new t.maps.Marker(e)},_createIcon:function(e){var r=document.createElement("div");r.style.padding="2px";var n=document.createElement("div");n.style.cursor="pointer",n.style.textAlign="center",n.title="Click per activar o desactivar "+e.title,r.appendChild(n);var i=document.createElement("div");i.innerHTML='<img src="'+e.icon+'" alt="'+e.title+'" >',n.appendChild(i),this.gMap.controls[t.maps.ControlPosition.RIGHT_TOP].push(r);var s=this;return t.maps.event.addDomListener(n,"click",function(){e.visible?(e.visible=!1,i.style.opacity="0.5"):(e.visible=!0,i.style.opacity="1"),s._setVisible(e.categoria,e.visible),s.markerClusterer.resetViewport_(),s.markerClusterer.redraw_()}),r},_setVisible:function(e,t){t?this.enableBy(function(t){return t.categoria===e}):this.disableBy(function(t){return t.categoria===e})},addIcon:function(e){var t;t=this._createIcon(e),this.icons.add(t)},removeIcon:function(e){},addMarker:function(e){var r;e.position={lat:e.lat,lng:e.lng},r=this._createMarker(e),this.markerClusterer.addMarker(r),this.markers.add(r),this.bounds.extend(r.getPosition()),e.event&&this._on({obj:r,event:e.event.name,callback:e.event.callback}),e.content&&(this._on({obj:r,event:"click",callback:function(){this.infowindow.setContent(e.content),this.infowindow.open(this.gMap,r)}}),t.maps.event.addListener(this.infowindow,"domready",function(){var e=$(".gm-style-iw").prev();e.css({"background-color":"#fff6eb"}),e.children(":nth-child(4)").css({"background-color":"#fff6eb"}),e.children(":nth-child(3)").children(":nth-child(1)").children(":nth-child(1)").css({"background-color":"#fff6eb"}),e.children(":nth-child(3)").children(":nth-child(2)").children(":nth-child(1)").css({"background-color":"#fff6eb"})}))},findBy:function(e){return this.markers.find(e)},removeBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){t.markerClusterer?t.markerClusterer.removeMarker(e):e.setMap(null)})})},enableBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){e.setVisible(!0),t.markerClusterer.addMarker(e,!0)})}),this._resize()},disableBy:function(e){var t=this;t.markers.find(e,function(e){e.forEach(function(e){e.setVisible(!1),t.markerClusterer.removeMarker(e,!0)})}),this._resize()},zoom:function(e){if(!e)return this.gMap.getZoom();this.gMap.setZoom(e)}},e}();n.create=function(e,t,r){var e=document.getElementById(e);return new n(e,t,r)},e.Gmap=n}(window,google,List);